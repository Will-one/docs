(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{559:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"p53-p56-解决跨域问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#p53-p56-解决跨域问题"}},[t._v("#")]),t._v(" P53-P56 解决跨域问题")]),t._v(" "),a("ol",[a("li",[t._v("配置响应头"),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// P53 配置响应头解决跨域")]),t._v("\nres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[t._v("直接使用中间件 cors\n先npm i cors"),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cors "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cors'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("usr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[t._v("jsonp 用的少")])]),t._v(" "),a("h2",{attrs:{id:"cors响应头"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cors响应头"}},[t._v("#")]),t._v(" CORS响应头")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("响应头部中可以携带一个 Access-Control-Allow-Origin")]),t._v(" "),a("ul",[a("li",[t._v("语法：")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Access-Control-Allow-Origin : <origin> | *\n")])])]),a("ul",[a("li",[t._v("示例：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意：当使用post方式发送请求带json时，请求头中会有 Content-Type = application/json 属性")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CORS 默认不支持【详情见2】，所以需要显示的指定")]),t._v("\nres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Headers'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 其中，origin参数的值指定了允许访问该资源的外域URL。")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 例如，下面的字段值将只允许来自 http://itcast.cn的请求")]),t._v("\nres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Origin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://itcast.cn'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Access-Control-Allow-Headers")]),t._v(" "),a("ul",[a("li",[t._v("默认情况下，CORS仅支持客户端向服务器发送如下的9个请求头：\nAccept、Accept-Language、Content-Language、DPR、DownLink、Save-Data、Viewport-Width、Width、\nContent-Type（值仅限于 text/plain、multipart/form-data、application/x-www-form-urlencoded三者之一）")]),t._v(" "),a("li",[t._v("如果客户端向服务器发送额外的请求头信息，则需要再服务器端，通过Access-Control-Allow-Headers 对额外请求头进行声明。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许客户端额外向服务端发送 Content-Type 请求头 和 X-Custom-Header 请求头")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意：多个请求头之间用逗号分隔")]),t._v("\nres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Headers'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type, X-Custom-Header'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("Access-Control-Allow-Methods")]),t._v(" "),a("ul",[a("li",[t._v("默认情况下，CORS 仅支持客户端发起 GET、POST、HEAD请求。")]),t._v(" "),a("li",[t._v("如果想通过 PUT、DELETE 等方式请求服务器的资源，则需要再服务器端，通过Access-Control-Allow-Methods来指明")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许 POST, GET, DELETE, HEAD")]),t._v("\nres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Methods'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'POST, GET, DELETE, HEAD'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许 所有HTTP请求方式")]),t._v("\nres"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Access-Control-Allow-Methods'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("h2",{attrs:{id:"p55-cors的简单请求与预检请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#p55-cors的简单请求与预检请求"}},[t._v("#")]),t._v(" P55 cors的简单请求与预检请求")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("简单请求")]),t._v(" "),a("ul",[a("li",[t._v("同时满足以下两大条件的请求，就属于简单请求：\n"),a("ol",[a("li",[t._v("请求方式：GET、POST、HEAD")]),t._v(" "),a("li",[t._v("HTTP的头部信息不超过以下几种字段：无自定义头部字段、Accept、Accept-Language、Content-Language、DPR、DownLink、Save-Data、Viewport-Width、Width、\nContent-Type（值仅限于 text/plain、multipart/form-data、application/x-www-form-urlencoded三者之一）")])])])])]),t._v(" "),a("li",[a("p",[t._v("预检请求")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("只要符合以下任何一个条件的请求，都需要进行预检请求：")]),t._v(" "),a("ol",[a("li",[t._v("请求方式：GET、POST、HEAD之外的请求")]),t._v(" "),a("li",[t._v("请求头中包含自定义头部字段")]),t._v(" "),a("li",[t._v("向服务器发送了 application/json格式的数据")])])]),t._v(" "),a("li",[a("p",[t._v("在浏览器与服务器正式通信之前，浏览器会先发送 OPTION 请求进行预检，以获知服务器是否允许该实际请求。")])]),t._v(" "),a("li",[a("p",[t._v("所以这一次的OPTION请求称为“预检请求”。服务器成功响应预检请求后，才会发送真正的请求，并携带真实数据。")])])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);